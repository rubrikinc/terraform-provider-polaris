---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "polaris_azure_subscription Resource - terraform-provider-polaris"
subcategory: ""
description: |-
  The polaris_azure_subscription resource adds an Azure subscription to RSC.
  When the first subscription for an Azure tenant is added, a corresponding tenant
  is created in RSC. The RSC tenant is automatically destroyed when it's last
  subscription is removed.
  Each feature's permissions field can be used with the
  polaris_azure_permissions data source to inform RSC about permission updates
  when the Terraform configuration is applied.
  Permission Groups
  Following is a list of features and their applicable permission groups. These
  are used when specifying the feature set.
  AZURE_SQL_DB_PROTECTION
  BASIC - Represents the basic set of permissions required to onboard the
  feature.RECOVERY - Represents the set of permissions required for all recovery
  operations.BACKUP_V2 - Represents the set of permissions required for immutable
  backup V2 operations.
  AZURE_SQL_MI_PROTECTION
  BASIC - Represents the basic set of permissions required to onboard the
  feature.RECOVERY - Represents the set of permissions required for all recovery
  operations.BACKUP_V2 - Represents the set of permissions required for immutable
  backup V2 operations.
  CLOUD_NATIVE_ARCHIVAL
  BASIC - Represents the basic set of permissions required to onboard the
  feature.ENCRYPTION - Represents the set of permissions required for encryption
  operation.SQL_ARCHIVAL - Represents the permissions required to enable Azure AD
  authorization to store Azure SQL and MI snapshots in an archival location.
  CLOUD_NATIVE_ARCHIVAL_ENCRYPTION
  BASIC - Represents the basic set of permissions required to onboard the
  feature.ENCRYPTION - Represents the set of permissions required for encryption
  operation.
  CLOUD_NATIVE_BLOB_PROTECTION
  BASIC - Represents the basic set of permissions required to onboard the
  feature.RECOVERY - Represents the set of permissions required for all recovery
  operations.
  CLOUD_NATIVE_PROTECTION
  BASIC - Represents the basic set of permissions required to onboard the
  feature.EXPORT_AND_RESTORE - Represents the set of permissions required for export
  and restore operations.FILE_LEVEL_RECOVERY - Represents the set of permissions required for
  file-level recovery operations.SNAPSHOT_PRIVATE_ACCESS - Represents the set of permissions required for
  private access to disk snapshots.
  EXOCOMPUTE
  BASIC - Represents the basic set of permissions required to onboard the
  feature.PRIVATE_ENDPOINTS - Represents the set of permissions required for usage
  of private endpoints.CUSTOMER_MANAGED_BASIC - Represents the permissions required to enable
  customer-managed Exocompute feature.
  ~> Note: Even though the resource_group_name and the
  resource_group_region fields are marked as optional you should always
  specify them. They are marked as optional to simplify the migration of
  existing Terraform configurations. If omitted, RSC will generate a unique
  resource group name but it will not create the actual resource group. Until
  the resource group is created, the RSC feature depending on the resource
  group will not function as expected.
  ~> Note: As mentioned in the documentation for each feature below, changing
  certain fields causes features to be re-onboarded. Take care when the
  subscription only has a single feature, as it could cause the tenant to be
  removed from RSC.
  -> Note: As of now, sql_mi_protection does not support specifying an Azure
  resource group.
---

# polaris_azure_subscription (Resource)

The `polaris_azure_subscription` resource adds an Azure subscription to RSC.
When the first subscription for an Azure tenant is added, a corresponding tenant
is created in RSC. The RSC tenant is automatically destroyed when it's last
subscription is removed.

Each feature's `permissions` field can be used with the
`polaris_azure_permissions` data source to inform RSC about permission updates
when the Terraform configuration is applied.

## Permission Groups
Following is a list of features and their applicable permission groups. These
are used when specifying the feature set.

`AZURE_SQL_DB_PROTECTION`
  * `BASIC` - Represents the basic set of permissions required to onboard the
    feature.
  * `RECOVERY` - Represents the set of permissions required for all recovery
    operations.
  * `BACKUP_V2` - Represents the set of permissions required for immutable
    backup V2 operations.

`AZURE_SQL_MI_PROTECTION`
  * `BASIC` - Represents the basic set of permissions required to onboard the
    feature.
  * `RECOVERY` - Represents the set of permissions required for all recovery
    operations.
  * `BACKUP_V2` - Represents the set of permissions required for immutable
    backup V2 operations.

`CLOUD_NATIVE_ARCHIVAL`
  * `BASIC` - Represents the basic set of permissions required to onboard the
    feature.
  * `ENCRYPTION` - Represents the set of permissions required for encryption
    operation.
  * `SQL_ARCHIVAL` - Represents the permissions required to enable Azure AD
    authorization to store Azure SQL and MI snapshots in an archival location.

`CLOUD_NATIVE_ARCHIVAL_ENCRYPTION`
  * `BASIC` - Represents the basic set of permissions required to onboard the
    feature.
  * `ENCRYPTION` - Represents the set of permissions required for encryption
    operation.

`CLOUD_NATIVE_BLOB_PROTECTION`
  * `BASIC` - Represents the basic set of permissions required to onboard the
    feature.
  * `RECOVERY` - Represents the set of permissions required for all recovery
    operations.

`CLOUD_NATIVE_PROTECTION`
  * `BASIC` - Represents the basic set of permissions required to onboard the
    feature.
  * `EXPORT_AND_RESTORE` - Represents the set of permissions required for export
    and restore operations.
  * `FILE_LEVEL_RECOVERY` - Represents the set of permissions required for
    file-level recovery operations.
  * `SNAPSHOT_PRIVATE_ACCESS` - Represents the set of permissions required for
    private access to disk snapshots.

`EXOCOMPUTE`
  * `BASIC` - Represents the basic set of permissions required to onboard the
    feature.
  * `PRIVATE_ENDPOINTS` - Represents the set of permissions required for usage
    of private endpoints.
  * `CUSTOMER_MANAGED_BASIC` - Represents the permissions required to enable
    customer-managed Exocompute feature.

~> **Note:** Even though the `resource_group_name` and the
   `resource_group_region` fields are marked as optional you should always
   specify them. They are marked as optional to simplify the migration of
   existing Terraform configurations. If omitted, RSC will generate a unique
   resource group name but it will not create the actual resource group. Until
   the resource group is created, the RSC feature depending on the resource
   group will not function as expected.

~> **Note:** As mentioned in the documentation for each feature below, changing
   certain fields causes features to be re-onboarded. Take care when the
   subscription only has a single feature, as it could cause the tenant to be
   removed from RSC.

-> **Note:** As of now, `sql_mi_protection` does not support specifying an Azure
   resource group.

## Example Usage

```terraform
data "polaris_azure_permissions" "cloud_native_protection" {
  feature = "CLOUD_NATIVE_PROTECTION"
  permission_groups = [
    "BASIC",
    "EXPORT_AND_RESTORE",
    "FILE_LEVEL_RECOVERY",
  ]
}


data "polaris_azure_permissions" "exocompute" {
  feature = "EXOCOMPUTE"
  permission_groups = [
    "BASIC",
  ]
}

resource "polaris_azure_subscription" "subscription" {
  subscription_id = "31be1bb0-c76c-11eb-9217-afdffe83a002"
  tenant_domain   = "my-domain.onmicrosoft.com"

  cloud_native_protection {
    permissions           = data.polaris_azure_permissions.cloud_native_protection.id
    permission_groups     = data.polaris_azure_permissions.cloud_native_protection.permission_groups
    resource_group_name   = "my-cloud-native-protection-rg"
    resource_group_region = "eastus2"

    regions = [
      "eastus2",
    ]
  }

  exocompute {
    permissions           = data.polaris_azure_permissions.exocompute.id
    permission_groups     = data.polaris_azure_permissions.exocompute.permission_groups
    resource_group_name   = "my-exocompute-rg"
    resource_group_region = "eastus2"

    regions = [
      "eastus2",
    ]
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `subscription_id` (String) Azure subscription ID. Changing this forces a new resource to be created.
- `tenant_domain` (String) Azure tenant primary domain. Changing this forces a new resource to be created.

### Optional

- `cloud_native_archival` (Block List, Max: 1) Enable the RSC Cloud Native Archival feature for the Azure subscription. Provides archival of data from workloads for disaster recovery and long-term retention. (see [below for nested schema](#nestedblock--cloud_native_archival))
- `cloud_native_archival_encryption` (Block List, Max: 1) Enable the RSC Cloud Native Archival Encryption feature for the Azure subscription. Allows cloud archival locations to be encrypted with customer managed keys. (see [below for nested schema](#nestedblock--cloud_native_archival_encryption))
- `cloud_native_blob_protection` (Block List, Max: 1) Enable the RSC Cloud Native Protection feature for Azure Blob Storage. Provides protection for Azure Blob Storage through the rules and policies of SLA Domains. (see [below for nested schema](#nestedblock--cloud_native_blob_protection))
- `cloud_native_protection` (Block List, Max: 1) Enable the RSC Cloud Native Protection feature for the Azure subscription. Provides protection for Azure virtual machines and managed disks through the rules and policies of SLA Domains. (see [below for nested schema](#nestedblock--cloud_native_protection))
- `delete_snapshots_on_destroy` (Boolean) Should snapshots be deleted when the resource is destroyed. Default value is `false`.
- `exocompute` (Block List, Max: 1) Enable the RSC Exocompute feature for the Azure subscription. Provides snapshot indexing, file recovery, storage tiering, and application-consistent protection of Azure objects. (see [below for nested schema](#nestedblock--exocompute))
- `sql_db_protection` (Block List, Max: 1) Enable the RSC SQL DB Protection feature for the Azure subscription. Provides centralized database backup management and recovery in an Azure SQL Database deployment. (see [below for nested schema](#nestedblock--sql_db_protection))
- `sql_mi_protection` (Block List, Max: 1) Enable the RSC SQL MI Protection feature for the Azure subscription. Provides centralized database backup management and recovery for an Azure SQL Managed Instance deployment. (see [below for nested schema](#nestedblock--sql_mi_protection))
- `subscription_name` (String) Azure subscription name.

### Read-Only

- `id` (String) RSC cloud account ID (UUID).

<a id="nestedblock--cloud_native_archival"></a>
### Nested Schema for `cloud_native_archival`

Required:

- `regions` (Set of String) Azure regions to enable the Cloud Native Archival feature in. Should be specified in the standard Azure style, e.g. `eastus`.

Optional:

- `permission_groups` (Set of String) Permission groups to assign to the Cloud Native Archival feature. Possible values are `BASIC`, `ENCRYPTION` and `SQL_ARCHIVAL`.
- `permissions` (String) Permissions updated signal. When this field changes, the provider will notify RSC that the permissions for the feature has been updated. Use this field with the `polaris_azure_permissions` data source.
- `resource_group_name` (String) Name of the Azure resource group where RSC places all resources created by the feature. RSC assumes the resource group already exists. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_region` (String) Region of the Azure resource group. Should be specified in the standard Azure style, e.g. `eastus`. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_tags` (Map of String) Tags to add to the Azure resource group. Changing this forces the RSC feature to be re-onboarded.

Read-Only:

- `status` (String) Status of the Cloud Native Archival feature.


<a id="nestedblock--cloud_native_archival_encryption"></a>
### Nested Schema for `cloud_native_archival_encryption`

Required:

- `regions` (Set of String) Azure regions to enable the Cloud Native Archival Encryption feature in. Should be specified in the standard Azure style, e.g. `eastus`.
- `user_assigned_managed_identity_name` (String) User-assigned managed identity name.
- `user_assigned_managed_identity_principal_id` (String) ID of the service principal object associated with the user-assigned managed identity.
- `user_assigned_managed_identity_region` (String) User-assigned managed identity region. Should be specified in the standard Azure style, e.g. `eastus`.
- `user_assigned_managed_identity_resource_group_name` (String) User-assigned managed identity resource group name.

Optional:

- `permission_groups` (Set of String) Permission groups to assign to the Cloud Native Archival Encryption feature. Possible values are `BASIC` and `ENCRYPTION`.
- `permissions` (String) Permissions updated signal. When this field changes, the provider will notify RSC that the permissions for the feature has been updated. Use this field with the `polaris_azure_permissions` data source.
- `resource_group_name` (String) Name of the Azure resource group where RSC places all resources created by the feature. RSC assumes the resource group already exists. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_region` (String) Region of the Azure resource group. Should be specified in the standard Azure style, e.g. `eastus`. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_tags` (Map of String) Tags to add to the Azure resource group. Changing this forces the RSC feature to be re-onboarded.

Read-Only:

- `status` (String) Status of the Cloud Native Archival Encryption feature.


<a id="nestedblock--cloud_native_blob_protection"></a>
### Nested Schema for `cloud_native_blob_protection`

Required:

- `regions` (Set of String) Azure regions that RSC will monitor for resources to protect according to SLA Domains. Should be specified in the standard Azure style, e.g. `eastus`.

Optional:

- `permission_groups` (Set of String) Permission groups to assign to the Cloud Native Blob Protection feature. Possible values are `BASIC` and `RECOVERY`.
- `permissions` (String) Permissions updated signal. When this field changes, the provider will notify RSC that the permissions for the feature has been updated. Use this field with the `polaris_azure_permissions` data source.

Read-Only:

- `status` (String) Status of the Cloud Native Blob Protection feature.


<a id="nestedblock--cloud_native_protection"></a>
### Nested Schema for `cloud_native_protection`

Required:

- `regions` (Set of String) Azure regions that RSC will monitor for resources to protect according to SLA Domains. Should be specified in the standard Azure style, e.g. `eastus`.

Optional:

- `permission_groups` (Set of String) Permission groups to assign to the Cloud Native Protection feature. Possible values are `BASIC`, `EXPORT_AND_RESTORE`, `FILE_LEVEL_RECOVERY`, `CLOUD_CLUSTER_ES` and `SNAPSHOT_PRIVATE_ACCESS`.
- `permissions` (String) Permissions updated signal. When this field changes, the provider will notify RSC that the permissions for the feature has been updated. Use this field with the `polaris_azure_permissions` data source.
- `resource_group_name` (String) Name of the Azure resource group where RSC places all resources created by the feature. RSC assumes the resource group already exists. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_region` (String) Region of the Azure resource group. Should be specified in the standard Azure style, e.g. `eastus`. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_tags` (Map of String) Tags to add to the Azure resource group. Changing this forces the RSC feature to be re-onboarded.

Read-Only:

- `status` (String) Status of the Cloud Native Protection feature.


<a id="nestedblock--exocompute"></a>
### Nested Schema for `exocompute`

Required:

- `regions` (Set of String) Azure regions to enable the Exocompute feature in. Should be specified in the standard Azure style, e.g. `eastus`.

Optional:

- `permission_groups` (Set of String) Permission groups to assign to the Exocompute feature. Possible values are `BASIC`, `PRIVATE_ENDPOINTS` and `CUSTOMER_MANAGED_BASIC`.
- `permissions` (String) Permissions updated signal. When this field changes, the provider will notify RSC that the permissions for the feature has been updated. Use this field with the `polaris_azure_permissions` data source.
- `resource_group_name` (String) Name of the Azure resource group where RSC places all resources created by the feature. RSC assumes the resource group already exists. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_region` (String) Region of the Azure resource group. Should be specified in the standard Azure style, e.g. `eastus`. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_tags` (Map of String) Tags to add to the Azure resource group. Changing this forces the RSC feature to be re-onboarded.

Read-Only:

- `status` (String) Status of the Exocompute feature.


<a id="nestedblock--sql_db_protection"></a>
### Nested Schema for `sql_db_protection`

Required:

- `regions` (Set of String) Azure regions to enable the SQL DB Protection feature in. Should be specified in the standard Azure style, e.g. `eastus`.

Optional:

- `permission_groups` (Set of String) Permission groups to assign to the SQL DB Protection feature. Possible values are `BASIC`, `RECOVERY` and `BACKUP_V2`.
- `permissions` (String) Permissions updated signal. When this field changes, the provider will notify RSC that the permissions for the feature has been updated. Use this field with the `polaris_azure_permissions` data source.
- `resource_group_name` (String) Name of the Azure resource group where RSC places all resources created by the feature. RSC assumes the resource group already exists. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_region` (String) Region of the Azure resource group. Should be specified in the standard Azure style, e.g. `eastus`. Changing this forces the RSC feature to be re-onboarded.
- `resource_group_tags` (Map of String) Tags to add to the Azure resource group. Changing this forces the RSC feature to be re-onboarded.

Read-Only:

- `status` (String) Status of the SQL DB Protection feature.


<a id="nestedblock--sql_mi_protection"></a>
### Nested Schema for `sql_mi_protection`

Required:

- `regions` (Set of String) Azure regions to enable the SQL MI Protection feature in. Should be specified in the standard Azure style, e.g. `eastus`.

Optional:

- `permission_groups` (Set of String) Permission groups to assign to the SQL MI Protection feature. Possible values are `BASIC`, `RECOVERY` and `BACKUP_V2`.
- `permissions` (String) Permissions updated signal. When this field changes, the provider will notify RSC that the permissions for the feature has been updated. Use this field with the `polaris_azure_permissions` data source.

Read-Only:

- `status` (String) Status of the SQL MI Protection feature.

## Import

Import is supported using the following syntax:

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = polaris_azure_subscription.subscription
  id = "3d5b93aa-67a7-46b5-b2e4-7527bdd96c95"
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
% terraform import polaris_azure_subscription.subscription 3d5b93aa-67a7-46b5-b2e4-7527bdd96c95
```
