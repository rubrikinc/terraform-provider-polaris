---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "polaris_aws_cnp_account_attachments Resource - terraform-provider-polaris"
subcategory: ""
description: |-
  The aws_cnp_account_attachments resource attaches AWS instance profiles and AWS
  roles to an RSC cloud account.
  -> Note: The features field takes only the feature names and not the permission
     groups associated with the features.
---

# polaris_aws_cnp_account_attachments (Resource)

The `aws_cnp_account_attachments` resource attaches AWS instance profiles and AWS
roles to an RSC cloud account.

-> **Note:** The `features` field takes only the feature names and not the permission
   groups associated with the features.

## Example Usage

```terraform
# The configuration assumes that an AWS account has been been added
# to RSC and that one AWS IAM instance profile and role has been
# created for each RSC artifact.
resource "polaris_aws_cnp_account_attachments" "attachments" {
  account_id = polaris_aws_cnp_account.account.id
  features   = polaris_aws_cnp_account.account.feature.*.name

  dynamic "instance_profile" {
    for_each = aws_iam_instance_profile.profile
    content {
      key  = instance_profile.key
      name = instance_profile.value["arn"]
    }
  }

  dynamic "role" {
    for_each = aws_iam_role.role
    content {
      key         = role.key
      arn         = role.value["arn"]
      permissions = data.polaris_aws_cnp_permissions.permissions[role.key].id
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `account_id` (String) RSC cloud account ID (UUID). Changing this forces a new resource to be created.
- `features` (Set of String) RSC features. Possible values are `CLOUD_NATIVE_ARCHIVAL`, `CLOUD_NATIVE_PROTECTION`, `CLOUD_NATIVE_S3_PROTECTION`, `EXOCOMPUTE` and `RDS_PROTECTION`.
- `role` (Block Set, Min: 1) Roles to attach to the cloud account. (see [below for nested schema](#nestedblock--role))

### Optional

- `instance_profile` (Block Set) Instance profiles to attach to the cloud account. (see [below for nested schema](#nestedblock--instance_profile))

### Read-Only

- `id` (String) RSC cloud account ID (UUID).

<a id="nestedblock--role"></a>
### Nested Schema for `role`

Required:

- `arn` (String) AWS role ARN.
- `key` (String) RSC artifact key for the AWS role.

Optional:

- `permissions` (String) Permissions updated signal. When this field changes, the provider will notify RSC that the permissions for the feature has been updated. Use this field with the `id` field of the `polaris_aws_cnp_permissions` data source.


<a id="nestedblock--instance_profile"></a>
### Nested Schema for `instance_profile`

Required:

- `key` (String) RSC artifact key for the AWS instance profile.
- `name` (String) AWS instance profile name.
