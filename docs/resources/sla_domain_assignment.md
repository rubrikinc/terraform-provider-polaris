---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "polaris_sla_domain_assignment Resource - terraform-provider-polaris"
subcategory: ""
description: |-
  The polaris_sla_domain_assignment resource is used to assign SLA domains to
  objects.
  When an object is removed from the polaris_sla_domain_assignment resource, it
  will inherit the SLA Domain of its parent object. If there is no parent object
  or the parent object doesn't have an SLA Domain, the object will be unprotected.
  Existing snapshots of the object will be retained according to the SLA Domain
  inherited from the parent object. If the parent object doesn't have an SLA
  Domain, the existing snapshots will be retained forever.
  The assignment_type attribute controls how the SLA domain is assigned:
  
  protectWithSlaId - Protect objects with the specified SLA domain. Requires sla_domain_id to be set.
  doNotProtect - Do not protect objects. Requires that sla_domain_id isn't set.
  ~> Note: When importing, apply_changes_to_existing_snapshots and
  apply_changes_to_non_policy_snapshots cannot be retrieved from the API.
  These attributes will use their default values after import.
---

# polaris_sla_domain_assignment (Resource)

The `polaris_sla_domain_assignment` resource is used to assign SLA domains to
objects.

When an object is removed from the `polaris_sla_domain_assignment` resource, it
will inherit the SLA Domain of its parent object. If there is no parent object
or the parent object doesn't have an SLA Domain, the object will be unprotected.
Existing snapshots of the object will be retained according to the SLA Domain
inherited from the parent object. If the parent object doesn't have an SLA
Domain, the existing snapshots will be retained forever.

The `assignment_type` attribute controls how the SLA domain is assigned:

  * `protectWithSlaId` - Protect objects with the specified SLA domain. Requires `sla_domain_id` to be set.

  * `doNotProtect` - Do not protect objects. Requires that `sla_domain_id` isn't set.

~> **Note:** When importing, `apply_changes_to_existing_snapshots` and
`apply_changes_to_non_policy_snapshots` cannot be retrieved from the API.
These attributes will use their default values after import.

## Example Usage

```terraform
data "polaris_sla_domain" "bronze" {
  name = "bronze"
}

# Create a tag rule for AWS EC2 instances.
resource "polaris_tag_rule" "aws_bronze" {
  name        = "aws-bronze"
  object_type = "AWS_EC2_INSTANCE"
  tag_key     = "backup"
  tag_value   = "true"
}

# Create a tag rule for Azure VM instances.
resource "polaris_tag_rule" "azure_bronze" {
  name        = "azure-bronze"
  object_type = "AZURE_VIRTUAL_MACHINE"
  tag_key     = "backup"
  tag_value   = "true"
}

# Assign the tag rules to the bronze SLA domain.
resource "polaris_sla_domain_assignment" "bronze" {
  sla_domain_id = data.polaris_sla_domain.bronze.id

  object_ids = [
    polaris_tag_rule.aws_bronze.id,
    polaris_tag_rule.azure_bronze.id,
  ]
}

# Create a tag rule for development instances that should not be protected.
resource "polaris_tag_rule" "dev_instances" {
  name        = "dev-instances"
  object_type = "AWS_EC2_INSTANCE"
  tag_key     = "environment"
  tag_value   = "dev"
}

# Mark development instances as Do Not Protect.
resource "polaris_sla_domain_assignment" "unprotected" {
  assignment_type             = "doNotProtect"
  existing_snapshot_retention = "RETAIN_SNAPSHOTS"

  object_ids = [
    polaris_tag_rule.dev_instances.id,
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `object_ids` (Set of String) Object IDs (UUID).

### Optional

- `apply_changes_to_existing_snapshots` (Boolean) Apply SLA changes to existing snapshots. Only valid when `assignment_type` is `protectWithSlaId`. Defaults to `true`.
- `apply_changes_to_non_policy_snapshots` (Boolean) Apply SLA changes to non-policy snapshots. Only valid when `assignment_type` is `protectWithSlaId`. Defaults to `false`.
- `assignment_type` (String) SLA domain assignment type. Valid values are `protectWithSlaId` and `doNotProtect`. Defaults to `protectWithSlaId`.
- `existing_snapshot_retention` (String) Existing snapshot retention policy. Only valid when `assignment_type` is `doNotProtect`. Valid values are `RETAIN_SNAPSHOTS`, `KEEP_FOREVER`, and `EXPIRE_IMMEDIATELY`.
- `sla_domain_id` (String) SLA domain ID (UUID). Required when `assignment_type` is `protectWithSlaId`.

### Read-Only

- `id` (String) SLA domain ID (UUID).

## Import

Import is supported using the following syntax:

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
# For protectWithSlaId assignments (using SLA domain UUID):
import {
  to = polaris_sla_domain_assignment.bronze
  id = "0e55e625-b78d-4e83-87f3-90313a980211"
}

# For doNotProtect assignments (using doNotProtect:<object_id1>,<object_id2>,...):
import {
  to = polaris_sla_domain_assignment.unprotected
  id = "doNotProtect:0e55e625-b78d-4e83-87f3-90313a980211,1a2b3c4d-5e6f-7890-abcd-ef1234567890"
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
# For protectWithSlaId assignments (using SLA domain UUID):
% terraform import polaris_sla_domain_assignment.bronze 0e55e625-b78d-4e83-87f3-90313a980211

# For doNotProtect assignments (using doNotProtect:<object_id1>,<object_id2>,...):
% terraform import polaris_sla_domain_assignment.unprotected "doNotProtect:0e55e625-b78d-4e83-87f3-90313a980211"
```
